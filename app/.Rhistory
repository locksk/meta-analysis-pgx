plot.title = element_text(colour = "#A2AEB3"))
#all_cogs$Summarised_by[all_cogs$Summarised_by == "Ellie"] <- "EE"
#all_cogs$Summarised_by[all_cogs$Summarised_by == "SB"] <- "SC"
all_cogs$Summarised_by[all_cogs$Summarised_by == "CDNotes taken from PARIS and summarised"] <- "CD"
all_cogs$Summarised_by[all_cogs$Summarised_by == "James T"] <- "JT"
all_cogs$Summarised_by[all_cogs$Summarised_by == "JT started, completed by AL (case-note summary & forensic)."] <- "JT and AL"
#all_cogs$sumstrat[all_cogs$Summarised_by == "AL"] <- "S1"
#all_cogs$sumstrat[all_cogs$Summarised_by == "AL and SC"] <- "misc"
#all_cogs$sumstrat[all_cogs$Summarised_by == "AL/EE"] <- "misc"
#all_cogs$sumstrat[all_cogs$Summarised_by == "AM"] <- "S2"
#all_cogs$sumstrat[all_cogs$Summarised_by == "AM + CD"] <- "misc"
#all_cogs$sumstrat[all_cogs$Summarised_by == "AM and EE"] <- "misc"
#all_cogs$sumstrat[all_cogs$Summarised_by == "CD"] <- "S3"
#all_cogs$sumstrat[all_cogs$Summarised_by == "CDNotes taken from PARIS and summarised"] <- "S3"
#all_cogs$sumstrat[all_cogs$Summarised_by == "CH"] <- "S4"
#all_cogs$sumstrat[all_cogs$Summarised_by == "EE"] <- "S5"
#all_cogs$sumstrat[all_cogs$Summarised_by == "EE + CD"] <- "misc"
#all_cogs$sumstrat[all_cogs$Summarised_by == "EJ"] <- "S6"
#all_cogs$sumstrat[all_cogs$Summarised_by == "Ellie"] <- "S7"
#all_cogs$sumstrat[all_cogs$Summarised_by == "GD"] <- "S8"
#all_cogs$sumstrat[all_cogs$Summarised_by == "James T"] <- "S9"
#all_cogs$sumstrat[all_cogs$Summarised_by == "JT"] <- "S9"
#all_cogs$sumstrat[all_cogs$Summarised_by == "JG"] <- "S10"
#all_cogs$sumstrat[all_cogs$Summarised_by == "JG + CD"] <- "misc"
#all_cogs$sumstrat[all_cogs$Summarised_by == "JT"] <- "S11"
#all_cogs$sumstrat[all_cogs$Summarised_by == "JT and AL"] <- "misc"
#all_cogs$sumstrat[all_cogs$Summarised_by == "JT started, completed by AL (case-note summary & forensic). "] <- "misc"
#all_cogs$sumstrat[all_cogs$Summarised_by == "KB"] <- "S11"
#all_cogs$sumstrat[all_cogs$Summarised_by == "LO"] <- "S12"
#all_cogs$sumstrat[all_cogs$Summarised_by == "LO & AL"] <- "misc"
#all_cogs$sumstrat[all_cogs$Summarised_by == "NR"] <- "S13"
#all_cogs$sumstrat[all_cogs$Summarised_by == "NR & SL"] <- "misc"
#all_cogs$sumstrat[all_cogs$Summarised_by == "RN"] <- "S14"
#all_cogs$sumstrat[all_cogs$Summarised_by == "SC"] <- "S15"
#all_cogs$sumstrat[all_cogs$Summarised_by == "SC and JG"] <- "misc"
#all_cogs$sumstrat[all_cogs$Summarised_by == "SL"] <- "S16"
#all_cogs$sumstrat[all_cogs$Summarised_by == "SL & NRExtra notes: AL"] <- "misc"
#all_cogs$sumstrat[all_cogs$Summarised_by == "ST"] <- "S17"
#a <- all_cogs %>% filter(grepl("AL", Summarised_by))
#unique(a$Summarised_by)
al_assoc <- c("AL", "AM", "EE", "JG", "JT", "LO", "NR", "SC", "SL", "CD", "LO & AL", "AL and SC",  "AL/EE", "SL & NRExtra notes: AL", "JT and AL", "SC and JG", "AM + CD", "NR & SL", "JG + CD", "AM and EE", "EE + CD")
remaining <- c("SB", "Ellie", "CH", "KB", "GD", "ST", "RN", "EJ", NA)
group1 <- all_cogs %>% filter(Summarised_by %in% al_assoc)
group2 <- all_cogs %>% filter(Summarised_by %in% remaining)
all_cogs$sumstrat <- "S1"
all_cogs$sumstrat[all_cogs$Summarised_by == "CH"] <- "S2a"
all_cogs$sumstrat[all_cogs$Summarised_by == "EJ"] <- "S2b"
all_cogs$sumstrat[all_cogs$Summarised_by == "Ellie"] <- "S2c"
all_cogs$sumstrat[all_cogs$Summarised_by == "GD"] <- "S2d"
all_cogs$sumstrat[all_cogs$Summarised_by == "KB"] <- "S2e"
all_cogs$sumstrat[all_cogs$Summarised_by == "RN"] <- "S2f"
all_cogs$sumstrat[all_cogs$Summarised_by == "SB"] <- "S2g"
all_cogs$sumstrat[all_cogs$Summarised_by == "ST"] <- "S2h"
all_cogs$sumstrat[all_cogs$Summarised_by == "NA"] <- "NA"
df <- as.data.frame(table(all_cogs$sumstrat))
df$pct <- ceiling(df$Freq/sum(df$Freq)*100)
colnames(df) <- c("group", "raw" , "value")
# Get the positions
df2 <- df %>%
mutate(csum = rev(cumsum(rev(value))),
pos = value/2 + lead(csum, 1),
pos = if_else(is.na(pos), value/2, pos))
ggplot(df, aes(x = "" , y = value, fill = fct_inorder(group))) +
geom_col(width = 1, color = 1) +
coord_polar(theta = "y") +
scale_fill_brewer(palette = "Pastel1") +
geom_label_repel(data = df2,
aes(y = pos, label = paste0(value, "%")),
size = 4.5, nudge_x = 1, show.legend = FALSE) +
guides(fill = guide_legend(title = "Group")) +
theme_void()
table(all_cogs$sumstrat)
table(all_cogs$sumstrat, useNA = "ifany")
all_cogs$sumstrat[all_cogs$Summarised_by == NA] <- "NA"
table(all_cogs$sumstrat, useNA = "ifany")
table(all_cogs$Summarised_by, useNA = "ifany")
table(all_cogs$Summarised_by)
all_cogs$sumstrat <- "S1"
all_cogs$sumstrat[all_cogs$Summarised_by == "CH"] <- "S2a"
all_cogs$sumstrat[all_cogs$Summarised_by == "EJ"] <- "S2b"
all_cogs$sumstrat[all_cogs$Summarised_by == "Ellie"] <- "S2c"
all_cogs$sumstrat[all_cogs$Summarised_by == "GD"] <- "S2d"
all_cogs$sumstrat[all_cogs$Summarised_by == "KB"] <- "S2e"
all_cogs$sumstrat[all_cogs$Summarised_by == "RN"] <- "S2f"
all_cogs$sumstrat[all_cogs$Summarised_by == "SB"] <- "S2g"
all_cogs$sumstrat[all_cogs$Summarised_by == "ST"] <- "S2h"
all_cogs %>% replace_na("Unknown")
all_cogs %>% replace_na(Summarised_by,"Unknown")
all_cogs %>% replace_na(Summarised_by, "Unknown")
rlang::last_trace()
all_cogs %>% replace_na(Summarised_by = "Unknown")
all_cogs %>% dplyr::mutate(Summarised_by = replace_na(Summarised_by, "Unknown"))
all_cogs <- all_cogs %>% dplyr::mutate(Summarised_by = replace_na(Summarised_by, "Unknown"))
table(all_cogs$Summarised_by)
all_cogs$sumstrat <- "S1"
all_cogs$sumstrat[all_cogs$Summarised_by == "CH"] <- "S2a"
all_cogs$sumstrat[all_cogs$Summarised_by == "EJ"] <- "S2b"
all_cogs$sumstrat[all_cogs$Summarised_by == "Ellie"] <- "S2c"
all_cogs$sumstrat[all_cogs$Summarised_by == "GD"] <- "S2d"
all_cogs$sumstrat[all_cogs$Summarised_by == "KB"] <- "S2e"
all_cogs$sumstrat[all_cogs$Summarised_by == "RN"] <- "S2f"
all_cogs$sumstrat[all_cogs$Summarised_by == "SB"] <- "S2g"
all_cogs$sumstrat[all_cogs$Summarised_by == "ST"] <- "S2h"
all_cogs <- all_cogs %>% dplyr::mutate(Summarised_by = replace_na(Summarised_by, "Unknown"))
all_cogs$sumstrat[all_cogs$Summarised_by == "Unknown"] <- "Unknown"
df <- as.data.frame(table(all_cogs$sumstrat))
df$pct <- ceiling(df$Freq/sum(df$Freq)*100)
colnames(df) <- c("group", "raw" , "value")
# Get the positions
df2 <- df %>%
mutate(csum = rev(cumsum(rev(value))),
pos = value/2 + lead(csum, 1),
pos = if_else(is.na(pos), value/2, pos))
ggplot(df, aes(x = "" , y = value, fill = fct_inorder(group))) +
geom_col(width = 1, color = 1) +
coord_polar(theta = "y") +
scale_fill_brewer(palette = "Pastel1") +
geom_label_repel(data = df2,
aes(y = pos, label = paste0(value, "%")),
size = 4.5, nudge_x = 1, show.legend = FALSE) +
guides(fill = guide_legend(title = "Group")) +
theme_void()
65+18
6+6+4+1+1+1+1+1
6+6+4
6+6
knitr::opts_chunk$set(echo = FALSE, fig.align = "center", dev = "png", dev.args=list(bg="transparent"))
library(DataExplorer)
library(haven)
library(tidyverse)
library(data.table)
library(thematic)
library(paletteer)
library(gtsummary)
library(igraph)
library(networkD3)
library(ggplot2)
library(ggrepel)
library(tidyverse)
setwd("C:/Users/siobhan/Documents/cogs_vignettes")
load("cogs_curated.RData")
#thematic_on(bg = "#120c0e", fg = "white", accent = "#eb99a1")
pal <- paletteer_d("palettetown::latias")
all_cogs$notes <- !is.na(all_cogs$Case_note_summary)
all_cogs$Date <- ymd(all_cogs$Date_of_interview)
all_cogs$Year <- year(all_cogs$Date)
tbl_summary(include = c(Sex, Age_at_Interview, notes, Genotyped, global_SAPS, global_SANS, NART,  GAS_Past_Week, clozapine_current), data = all_cogs, statistic = list(
all_continuous() ~ "{mean} ({sd}) [{median}, ({p25} - {p75})] ",
all_categorical() ~ "{n} ({p}%)"
), digits =  all_continuous() ~ 1, label = list(Sex ~ "Sex", Age_at_Interview ~ "Age", notes ~ "Have case notes", Genotyped ~ "Are genotyped", global_SAPS ~ "Overall SAPS", global_SANS ~ "Overall SANS", NART ~ "NART", GAS_Past_Week ~ "GAS (Past Week)", clozapine_current ~ "Current Clozapine")) %>%
modify_header(
label = "Variable",
stat_0 = "Mean (SD)[Median,(IQR)]; n (%)") %>%
modify_caption("Table 1. Descriptive information about CardiffCOGS vignette sample. Results are given as mean (standard deviation) [median, (IQR) for continuous variables, and number of observations (% of total) for categorical variables.")
#vars <- names(all_cogs[,18:162])
#all_cogs_m <- all_cogs
#all_cogs <- all_cogs %>% filter_at(vars(Sex, Age_at_Interview),all_vars(!is.na(.)))
# assess missingness
plot_missing(all_cogs, title = "Missing Data in CardiffCOGS Phenotypes & Vignettes", geom_label_args = list("size" = 2, "label.padding" = unit(0.1, "lines")))
plot_dates <- as.data.frame(all_cogs$Year)
ggplot(plot_dates, aes(x = all_cogs$Year)) +
geom_bar() +
labs(title = "Year of Interview") +
xlab("Year of Interview") +
ylab("Count") +
theme_minimal() +
theme(axis.title = element_text(colour = "#A2AEB3"),
axis.text.x = element_text(colour = "#A2AEB3", size = 8),
axis.text.y = element_text(colour = "#A2AEB3", size = 8),
axis.ticks = element_line(colour = "#A2AEB3"),
plot.title = element_text(colour = "#A2AEB3"))
all_cogs$dsm_labs <- all_cogs$DSM_diagnosis_new
all_cogs$dsm_labs <- factor(all_cogs$dsm_labs, levels = 1:8, labels = c("Schizophrenia", "Schizoaffective Depressed", "Schizoaffective Bipolar", "Other Psychotic", "Bipolar 1", "Bipolar 2", "Depression", "Other"))
ggplot(all_cogs, aes(x = dsm_labs)) +
geom_bar() +
labs(title = "DSM Diagnoses") +
xlab("Diagnosis") +
ylab("Count") +
theme_minimal() +
theme(axis.title = element_text(colour = "#A2AEB3"),
axis.text.x = element_text(colour = "#A2AEB3", size = 8, angle = 45, vjust = 0.85, hjust = 1),
axis.text.y = element_text(colour = "#A2AEB3", size = 8),
axis.ticks = element_line(colour = "#A2AEB3"),
plot.title = element_text(colour = "#A2AEB3"))
s1 <- filter(all_cogs, Summarised_by == "SC" | Summarised_by == "SB")
plot_dates <- as.data.frame(s1$Year)
ggplot(plot_dates, aes(x = s1$Year, fill = s1$Summarised_by)) +
geom_bar() +
labs(title = "SC vs SB") +
xlab("Year of Interview") +
ylab("Count") +
scale_fill_manual(values = pal) +
theme_minimal() +
theme(axis.title = element_text(colour = "#A2AEB3"),
axis.text.x = element_text(colour = "#A2AEB3", size = 8),
axis.text.y = element_text(colour = "#A2AEB3", size = 8),
axis.ticks = element_line(colour = "#A2AEB3"),
plot.title = element_text(colour = "#A2AEB3"))
s1 <- filter(all_cogs, Summarised_by == "ST" | Summarised_by == "SL")
plot_dates <- as.data.frame(s1$Year)
ggplot(plot_dates, aes(x = s1$Year, fill = s1$Summarised_by)) +
geom_bar() +
labs(title = "SL vs ST") +
xlab("Year of Interview") +
ylab("Count") +
scale_fill_manual(values = pal) +
theme_minimal() +
theme(axis.title = element_text(colour = "#A2AEB3"),
axis.text.x = element_text(colour = "#A2AEB3", size = 8),
axis.text.y = element_text(colour = "#A2AEB3", size = 8),
axis.ticks = element_line(colour = "#A2AEB3"),
plot.title = element_text(colour = "#A2AEB3"))
s1 <- filter(all_cogs, Summarised_by == "Ellie" | Summarised_by == "EE" | Summarised_by == "EJ")
plot_dates <- as.data.frame(s1$Year)
ggplot(plot_dates, aes(x = s1$Year, fill = s1$Summarised_by)) +
geom_bar() +
labs(title = "Ellie vs EE vs EJ") +
xlab("Year of Interview") +
ylab("Count") +
scale_fill_manual(values = pal) +
theme_minimal() +
theme(axis.title = element_text(colour = "#A2AEB3"),
axis.text.x = element_text(colour = "#A2AEB3", size = 8),
axis.text.y = element_text(colour = "#A2AEB3", size = 8),
axis.ticks = element_line(colour = "#A2AEB3"),
plot.title = element_text(colour = "#A2AEB3"))
table(all_cogs$Summarised_by)
all_cogs$Summarised_by[all_cogs$Summarised_by == "SB"] <- "SC"
all_cogs$Summarised_by[all_cogs$Summarised_by == "CDNotes taken from PARIS and summarised"] <- "CD"
all_cogs$Summarised_by[all_cogs$Summarised_by == "James T"] <- "JT"
all_cogs$Summarised_by[all_cogs$Summarised_by == "JT started, completed by AL (case-note summary & forensic)."] <- "JT & AL"
all_cogs$Summarised_by[all_cogs$Summarised_by == "SL & NRExtra notes: AL"] <- "SL & NR & AL"
all_cogs$Summarised_by[all_cogs$Summarised_by == "SC and JG"] <- "SC & JG"
all_cogs$Summarised_by[all_cogs$Summarised_by == "JT and AL"] <- "JT & AL"
all_cogs$Summarised_by[all_cogs$Summarised_by == "EE + CD"] <- "EE & CD"
all_cogs$Summarised_by[all_cogs$Summarised_by == "AM and EE"] <- "AM & EE"
all_cogs$Summarised_by[all_cogs$Summarised_by == "AM + CD"] <- "AM & CD"
all_cogs$Summarised_by[all_cogs$Summarised_by == "AL/EE"] <- "AL & EE"
all_cogs$Summarised_by[all_cogs$Summarised_by == "AL and SC"] <- "AL & SC"
table(all_cogs$Summarised_by)
st <- filter(all_cogs, Summarised_by == "ST")
table(st$Year)
all_cogs$sumstrat <- "S1"
all_cogs$sumstrat[all_cogs$Summarised_by == "CH"] <- "S2a"
all_cogs$sumstrat[all_cogs$Summarised_by == "EJ"] <- "S2b"
all_cogs$sumstrat[all_cogs$Summarised_by == "Ellie"] <- "S2c"
all_cogs$sumstrat[all_cogs$Summarised_by == "GD"] <- "S2d"
all_cogs$sumstrat[all_cogs$Summarised_by == "KB"] <- "S2e"
all_cogs$sumstrat[all_cogs$Summarised_by == "RN"] <- "S2f"
all_cogs$sumstrat[all_cogs$Summarised_by == "ST"] <- "S2g"
all_cogs <- all_cogs %>% dplyr::mutate(Summarised_by = replace_na(Summarised_by, "Unknown"))
all_cogs$sumstrat[all_cogs$Summarised_by == "Unknown"] <- "Unknown"
df <- as.data.frame(table(all_cogs$sumstrat))
df$pct <- ceiling(df$Freq/sum(df$Freq)*100)
colnames(df) <- c("group", "raw" , "value")
# Get the positions
df2 <- df %>%
mutate(csum = rev(cumsum(rev(value))),
pos = value/2 + lead(csum, 1),
pos = if_else(is.na(pos), value/2, pos))
ggplot(df, aes(x = "" , y = value, fill = fct_inorder(group))) +
geom_col(width = 1, color = 1) +
coord_polar(theta = "y") +
scale_fill_manual(values = pal) +
geom_label_repel(data = df2,
aes(y = pos, label = paste0(value, "%")),
size = 4.5, nudge_x = 1, show.legend = FALSE) +
guides(fill = guide_legend(title = "Group")) +
theme_void()
table(all_cogs$Summarised_by)
knitr::opts_chunk$set(echo = FALSE, fig.align = "center", dev = "png", dev.args=list(bg="transparent"))
library(DataExplorer)
library(haven)
library(tidyverse)
library(data.table)
library(thematic)
library(paletteer)
library(gtsummary)
library(igraph)
library(networkD3)
library(ggplot2)
library(ggrepel)
library(tidyverse)
setwd("C:/Users/siobhan/Documents/cogs_vignettes")
load("cogs_curated.RData")
#thematic_on(bg = "#120c0e", fg = "white", accent = "#eb99a1")
pal <- paletteer_d("palettetown::latias")
all_cogs$notes <- !is.na(all_cogs$Case_note_summary)
all_cogs$Date <- ymd(all_cogs$Date_of_interview)
all_cogs$Year <- year(all_cogs$Date)
tbl_summary(include = c(Sex, Age_at_Interview, notes, Genotyped, global_SAPS, global_SANS, NART,  GAS_Past_Week, clozapine_current), data = all_cogs, statistic = list(
all_continuous() ~ "{mean} ({sd}) [{median}, ({p25} - {p75})] ",
all_categorical() ~ "{n} ({p}%)"
), digits =  all_continuous() ~ 1, label = list(Sex ~ "Sex", Age_at_Interview ~ "Age", notes ~ "Have case notes", Genotyped ~ "Are genotyped", global_SAPS ~ "Overall SAPS", global_SANS ~ "Overall SANS", NART ~ "NART", GAS_Past_Week ~ "GAS (Past Week)", clozapine_current ~ "Current Clozapine")) %>%
modify_header(
label = "Variable",
stat_0 = "Mean (SD)[Median,(IQR)]; n (%)") %>%
modify_caption("Table 1. Descriptive information about CardiffCOGS vignette sample. Results are given as mean (standard deviation) [median, (IQR) for continuous variables, and number of observations (% of total) for categorical variables.")
#vars <- names(all_cogs[,18:162])
#all_cogs_m <- all_cogs
#all_cogs <- all_cogs %>% filter_at(vars(Sex, Age_at_Interview),all_vars(!is.na(.)))
# assess missingness
plot_missing(all_cogs, title = "Missing Data in CardiffCOGS Phenotypes & Vignettes", geom_label_args = list("size" = 2, "label.padding" = unit(0.1, "lines")))
plot_dates <- as.data.frame(all_cogs$Year)
ggplot(plot_dates, aes(x = all_cogs$Year)) +
geom_bar() +
labs(title = "Year of Interview") +
xlab("Year of Interview") +
ylab("Count") +
theme_minimal() +
theme(axis.title = element_text(colour = "#A2AEB3"),
axis.text.x = element_text(colour = "#A2AEB3", size = 8),
axis.text.y = element_text(colour = "#A2AEB3", size = 8),
axis.ticks = element_line(colour = "#A2AEB3"),
plot.title = element_text(colour = "#A2AEB3"))
all_cogs$dsm_labs <- all_cogs$DSM_diagnosis_new
all_cogs$dsm_labs <- factor(all_cogs$dsm_labs, levels = 1:8, labels = c("Schizophrenia", "Schizoaffective Depressed", "Schizoaffective Bipolar", "Other Psychotic", "Bipolar 1", "Bipolar 2", "Depression", "Other"))
ggplot(all_cogs, aes(x = dsm_labs)) +
geom_bar() +
labs(title = "DSM Diagnoses") +
xlab("Diagnosis") +
ylab("Count") +
theme_minimal() +
theme(axis.title = element_text(colour = "#A2AEB3"),
axis.text.x = element_text(colour = "#A2AEB3", size = 8, angle = 45, vjust = 0.85, hjust = 1),
axis.text.y = element_text(colour = "#A2AEB3", size = 8),
axis.ticks = element_line(colour = "#A2AEB3"),
plot.title = element_text(colour = "#A2AEB3"))
s1 <- filter(all_cogs, Summarised_by == "SC" | Summarised_by == "SB")
plot_dates <- as.data.frame(s1$Year)
ggplot(plot_dates, aes(x = s1$Year, fill = s1$Summarised_by)) +
geom_bar() +
labs(title = "SC vs SB") +
xlab("Year of Interview") +
ylab("Count") +
scale_fill_manual(values = pal) +
theme_minimal() +
theme(axis.title = element_text(colour = "#A2AEB3"),
axis.text.x = element_text(colour = "#A2AEB3", size = 8),
axis.text.y = element_text(colour = "#A2AEB3", size = 8),
axis.ticks = element_line(colour = "#A2AEB3"),
plot.title = element_text(colour = "#A2AEB3"))
s1 <- filter(all_cogs, Summarised_by == "ST" | Summarised_by == "SL")
plot_dates <- as.data.frame(s1$Year)
ggplot(plot_dates, aes(x = s1$Year, fill = s1$Summarised_by)) +
geom_bar() +
labs(title = "SL vs ST") +
xlab("Year of Interview") +
ylab("Count") +
scale_fill_manual(values = pal) +
theme_minimal() +
theme(axis.title = element_text(colour = "#A2AEB3"),
axis.text.x = element_text(colour = "#A2AEB3", size = 8),
axis.text.y = element_text(colour = "#A2AEB3", size = 8),
axis.ticks = element_line(colour = "#A2AEB3"),
plot.title = element_text(colour = "#A2AEB3"))
s1 <- filter(all_cogs, Summarised_by == "Ellie" | Summarised_by == "EE" | Summarised_by == "EJ")
plot_dates <- as.data.frame(s1$Year)
ggplot(plot_dates, aes(x = s1$Year, fill = s1$Summarised_by)) +
geom_bar() +
labs(title = "Ellie vs EE vs EJ") +
xlab("Year of Interview") +
ylab("Count") +
scale_fill_manual(values = pal) +
theme_minimal() +
theme(axis.title = element_text(colour = "#A2AEB3"),
axis.text.x = element_text(colour = "#A2AEB3", size = 8),
axis.text.y = element_text(colour = "#A2AEB3", size = 8),
axis.ticks = element_line(colour = "#A2AEB3"),
plot.title = element_text(colour = "#A2AEB3"))
all_cogs$Summarised_by[all_cogs$Summarised_by == "ST" & Year == 2010]
View(all_cogs)
all_cogs$Summarised_by[all_cogs$Summarised_by == "ST" & all_cogs$Year == 2010]
all_cogs$Summarised_by[all_cogs$Summarised_by == "ST" & all_cogs$Year == 2010] <- "SL"
table(all_cogs$Summarised_by)
knitr::opts_chunk$set(echo = FALSE, fig.align = "center", dev = "png", dev.args=list(bg="transparent"))
library(DataExplorer)
library(haven)
library(tidyverse)
library(data.table)
library(thematic)
library(paletteer)
library(gtsummary)
library(igraph)
library(networkD3)
library(ggplot2)
library(ggrepel)
library(tidyverse)
setwd("C:/Users/siobhan/Documents/cogs_vignettes")
load("cogs_curated.RData")
#thematic_on(bg = "#120c0e", fg = "white", accent = "#eb99a1")
pal <- paletteer_d("palettetown::latias")
all_cogs$notes <- !is.na(all_cogs$Case_note_summary)
all_cogs$Date <- ymd(all_cogs$Date_of_interview)
all_cogs$Year <- year(all_cogs$Date)
tbl_summary(include = c(Sex, Age_at_Interview, notes, Genotyped, global_SAPS, global_SANS, NART,  GAS_Past_Week, clozapine_current), data = all_cogs, statistic = list(
all_continuous() ~ "{mean} ({sd}) [{median}, ({p25} - {p75})] ",
all_categorical() ~ "{n} ({p}%)"
), digits =  all_continuous() ~ 1, label = list(Sex ~ "Sex", Age_at_Interview ~ "Age", notes ~ "Have case notes", Genotyped ~ "Are genotyped", global_SAPS ~ "Overall SAPS", global_SANS ~ "Overall SANS", NART ~ "NART", GAS_Past_Week ~ "GAS (Past Week)", clozapine_current ~ "Current Clozapine")) %>%
modify_header(
label = "Variable",
stat_0 = "Mean (SD)[Median,(IQR)]; n (%)") %>%
modify_caption("Table 1. Descriptive information about CardiffCOGS vignette sample. Results are given as mean (standard deviation) [median, (IQR) for continuous variables, and number of observations (% of total) for categorical variables.")
#vars <- names(all_cogs[,18:162])
#all_cogs_m <- all_cogs
#all_cogs <- all_cogs %>% filter_at(vars(Sex, Age_at_Interview),all_vars(!is.na(.)))
# assess missingness
plot_missing(all_cogs, title = "Missing Data in CardiffCOGS Phenotypes & Vignettes", geom_label_args = list("size" = 2, "label.padding" = unit(0.1, "lines")))
plot_dates <- as.data.frame(all_cogs$Year)
ggplot(plot_dates, aes(x = all_cogs$Year)) +
geom_bar() +
labs(title = "Year of Interview") +
xlab("Year of Interview") +
ylab("Count") +
theme_minimal() +
theme(axis.title = element_text(colour = "#A2AEB3"),
axis.text.x = element_text(colour = "#A2AEB3", size = 8),
axis.text.y = element_text(colour = "#A2AEB3", size = 8),
axis.ticks = element_line(colour = "#A2AEB3"),
plot.title = element_text(colour = "#A2AEB3"))
all_cogs$dsm_labs <- all_cogs$DSM_diagnosis_new
all_cogs$dsm_labs <- factor(all_cogs$dsm_labs, levels = 1:8, labels = c("Schizophrenia", "Schizoaffective Depressed", "Schizoaffective Bipolar", "Other Psychotic", "Bipolar 1", "Bipolar 2", "Depression", "Other"))
ggplot(all_cogs, aes(x = dsm_labs)) +
geom_bar() +
labs(title = "DSM Diagnoses") +
xlab("Diagnosis") +
ylab("Count") +
theme_minimal() +
theme(axis.title = element_text(colour = "#A2AEB3"),
axis.text.x = element_text(colour = "#A2AEB3", size = 8, angle = 45, vjust = 0.85, hjust = 1),
axis.text.y = element_text(colour = "#A2AEB3", size = 8),
axis.ticks = element_line(colour = "#A2AEB3"),
plot.title = element_text(colour = "#A2AEB3"))
s1 <- filter(all_cogs, Summarised_by == "SC" | Summarised_by == "SB")
plot_dates <- as.data.frame(s1$Year)
ggplot(plot_dates, aes(x = s1$Year, fill = s1$Summarised_by)) +
geom_bar() +
labs(title = "SC vs SB") +
xlab("Year of Interview") +
ylab("Count") +
scale_fill_manual(values = pal) +
theme_minimal() +
theme(axis.title = element_text(colour = "#A2AEB3"),
axis.text.x = element_text(colour = "#A2AEB3", size = 8),
axis.text.y = element_text(colour = "#A2AEB3", size = 8),
axis.ticks = element_line(colour = "#A2AEB3"),
plot.title = element_text(colour = "#A2AEB3"))
s1 <- filter(all_cogs, Summarised_by == "ST" | Summarised_by == "SL")
plot_dates <- as.data.frame(s1$Year)
ggplot(plot_dates, aes(x = s1$Year, fill = s1$Summarised_by)) +
geom_bar() +
labs(title = "SL vs ST") +
xlab("Year of Interview") +
ylab("Count") +
scale_fill_manual(values = pal) +
theme_minimal() +
theme(axis.title = element_text(colour = "#A2AEB3"),
axis.text.x = element_text(colour = "#A2AEB3", size = 8),
axis.text.y = element_text(colour = "#A2AEB3", size = 8),
axis.ticks = element_line(colour = "#A2AEB3"),
plot.title = element_text(colour = "#A2AEB3"))
s1 <- filter(all_cogs, Summarised_by == "Ellie" | Summarised_by == "EE" | Summarised_by == "EJ")
plot_dates <- as.data.frame(s1$Year)
ggplot(plot_dates, aes(x = s1$Year, fill = s1$Summarised_by)) +
geom_bar() +
labs(title = "Ellie vs EE vs EJ") +
xlab("Year of Interview") +
ylab("Count") +
scale_fill_manual(values = pal) +
theme_minimal() +
theme(axis.title = element_text(colour = "#A2AEB3"),
axis.text.x = element_text(colour = "#A2AEB3", size = 8),
axis.text.y = element_text(colour = "#A2AEB3", size = 8),
axis.ticks = element_line(colour = "#A2AEB3"),
plot.title = element_text(colour = "#A2AEB3"))
table(all_cogs$Summarised_by)
all_cogs$Summarised_by[all_cogs$Summarised_by == "SB"] <- "SC"
all_cogs$Summarised_by[all_cogs$Summarised_by == "ST" & Year == 2010] <- "SL"
all_cogs$Summarised_by[all_cogs$Summarised_by == "ST" & all_cogs$Year == 2010] <- "SL"
s1 <- filter(all_cogs, Summarised_by == "ST" | Summarised_by == "SL")
plot_dates <- as.data.frame(s1$Year)
ggplot(plot_dates, aes(x = s1$Year, fill = s1$Summarised_by)) +
geom_bar() +
labs(title = "SL vs ST") +
xlab("Year of Interview") +
ylab("Count") +
scale_fill_manual(values = pal) +
theme_minimal() +
theme(axis.title = element_text(colour = "#A2AEB3"),
axis.text.x = element_text(colour = "#A2AEB3", size = 8),
axis.text.y = element_text(colour = "#A2AEB3", size = 8),
axis.ticks = element_line(colour = "#A2AEB3"),
plot.title = element_text(colour = "#A2AEB3"))
View(plot_dates)
load("C:/Users/siobhan/OneDrive - Cardiff University/phd/PhD/Y2/pgx-smd/PGx Effect Sizes/all_smds.RData")
filter(all_smd, absmd <= 5)
filter(all_smd, all_smd$absmd <= 5)
a <- filter(all_smd, all_smd$absmd <= 5)
View(all_smd)
dplyr::filter(all_smd, absmd =< 5)
dplyr::filter(all_smd, absmd <= 5)
a <- dplyr::filter(all_smd, absmd <= 5)
remotes::install_github("hrbrmstr/hrbrthemes")
remotes::install_github("wch/extrafont")
remotes::install_github("hrbrmstr/hrbrthemes")
remotes::install_github("hrbrmstr/waffle")
shiny::runApp('C:/Users/siobhan/OneDrive - Cardiff University/phd/PhD/Y2/pgx-smd/PGx Effect Sizes/app/pgx_app/pgx_shiny/R')
remotes::install_github("dreamRs/shinypop")
runApp('C:/Users/siobhan/OneDrive - Cardiff University/phd/PhD/Y2/pgx-smd/PGx Effect Sizes/app/pgx_app/pgx_shiny/R')
runApp('C:/Users/siobhan/OneDrive - Cardiff University/phd/PhD/Y2/pgx-smd/PGx Effect Sizes/app/pgx_app/pgx_shiny/R')
setwd("C:/Users/siobhan/OneDrive - Cardiff University/phd/PhD/Y2/pgx-smd/PGx Effect Sizes/app/pgx_app/pgx_shiny/R")
runApp()
